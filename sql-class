-- SELECT * from "users" LIMIT 200;

-- Write query to find use name who contain john
SELECT * FROM "users" WHERE "username" LIKE '%john%';

-- Find all users who joined the platform in February 2023.
SELECT * FROM "users" WHERE "created_at" >= '2023-02-01' AND "created_at" < '2023-03-01';

-- Find all usernames that start with 'a' and sort them alphabetically.
SELECT * FROM "users" WHERE "username" LIKE 'a%' ORDER BY "username"


-- Count the total number of posts in the database.
SELECT COUNT(*) FROM "posts";

-- Count the number of posts made by each user.
SELECT user_id, COUNT(*) FROM "posts" GROUP BY user_id;

-- Count the number of posts made by each user and sort them in descending order.
SELECT user_id, COUNT(*) as post_count FROM "posts" GROUP BY user_id ORDER BY post_count DESC LIMIT 10;

-- Count the number of comments made by each user.
SELECT user_id, COUNT(*) FROM comments
GROUP BY user_id;

-- Find the average length of usernames in the users table.
SELECT username, LENGTH(username) as username_length FROM "users"

-- eg: Find the average length of comments in the comments table.
SELECT username, AVG(LENGTH(comments)) AS avg_comment_length 
FROM "comments" 
GROUP BY username
ORDER BY avg_comment_length DESC;

-- Find all posts with more than 2 reactions.
-- SELECT * FROM "posts" WHERE "reaction_count" > 2;

SELECT post_id, COUNT(*) as reaction_count
FROM "reactions"
GROUP BY post_id
HAVING COUNT(*) > 2;

-- Find all users who have made more than 6 comments.
SELECT user_id, COUNT(*) as comment_count
FROM "comments"
GROUP BY user_id
HAVING COUNT(*) > 6;

-- Count the total number of posts in the database.
SELECT COUNT(*) FROM "posts";

-- Count how many comments each post has received.
SELECT post_id, COUNT(*) 
AS comment_count
FROM "comments"
GROUP BY post_id;

-- Find all users who have created more than 1 post.
SELECT user_id, COUNT(*) AS post_count
FROM "posts"
GROUP BY user_id
HAVING COUNT(*) > 1;




